import React, { useState } from 'react';
import { Network, Brain, Database, Sprout, Scale, Fingerprint, RefreshCcw, BookOpen, Layers, Zap, MessageSquare, Lightbulb, Sparkles, Terminal } from 'lucide-react';

const MindMap = () => {
  const [hoveredNode, setHoveredNode] = useState(null);

  // Definição dos nós e suas posições
  const nodes = [
    // LADO ANCESTRALIDADE
    { id: 'ancestralidade', x: 150, y: 300, label: 'Ancestralidade', type: 'root', theme: 'organic', icon: Sprout, 
      desc: 'A base biológica, cultural e histórica. O acúmulo de sabedoria não codificada em binário.' },
    { id: 'oralidade', x: 100, y: 150, label: 'Oralidade & Mito', type: 'sub', theme: 'organic', icon: MessageSquare,
      desc: 'A transmissão de conhecimento via narrativa. A IA (LLMs) é uma nova forma de oralidade ou apenas uma simulação estatística dela?' },
    { id: 'memoria', x: 220, y: 450, label: 'Memória Coletiva', type: 'sub', theme: 'organic', icon: Layers,
      desc: 'O que decidimos lembrar. A IA preserva a memória ou a achata em padrões repetitivos?' },
    { id: 'identidade', x: 80, y: 400, label: 'Identidade & Raízes', type: 'sub', theme: 'organic', icon: Fingerprint,
      desc: 'Quem somos. Como algoritmos de recomendação moldam (ou distorcem) nossa percepção de pertencimento?' },

    // LADO INTELIGÊNCIA ARTIFICIAL
    { id: 'ia', x: 650, y: 300, label: 'Inteligência Artificial', type: 'root', theme: 'tech', icon: Brain,
      desc: 'Processamento de dados em escala. Simulação de cognição. Não cria "do nada", mas reordena o que já existe.' },
    { id: 'dados', x: 700, y: 150, label: 'Big Data (Datasets)', type: 'sub', theme: 'tech', icon: Database,
      desc: 'O novo arquivo histórico. Se o dataset (o passado digitalizado) é tendencioso, a IA herda o preconceito dos nossos ancestrais.' },
    { id: 'algoritmos', x: 580, y: 450, label: 'Algoritmos', type: 'sub', theme: 'tech', icon: Network,
      desc: 'As regras do jogo. Quem são os "novos anciãos" que escrevem essas regras éticas?' },
    { id: 'automacao', x: 720, y: 400, label: 'Automação Cognitiva', type: 'sub', theme: 'tech', icon: Zap,
      desc: 'Terceirização do pensar. Estamos perdendo a capacidade de raciocínio profundo herdada de milênios de evolução?' },

    // CENTRO - CONEXÕES E TENSÕES
    { id: 'vies', x: 400, y: 200, label: 'Viés Algorítmico', type: 'bridge', theme: 'critical', icon: Scale,
      desc: 'O PONTO CRÍTICO: O viés da IA é a "herança" não examinada dos nossos antepassados racistas/sexistas embutida no código.' },
    { id: 'preservacao', x: 400, y: 400, label: 'Preservação Digital', type: 'bridge', theme: 'critical', icon: RefreshCcw,
      desc: 'A tecnologia usada para salvar línguas indígenas e reconstruir histórias perdidas. A ferramenta serve ao mestre ou à memória?' },
    { id: 'etica', x: 400, y: 300, label: 'Ética & O Futuro', type: 'bridge', theme: 'critical', icon: BookOpen,
      desc: 'Para onde vamos? A sabedoria ancestral focava na sobrevivência do grupo a longo prazo; a IA foca na otimização imediata.' }
  ];

  const connections = [
    { from: 'ancestralidade', to: 'oralidade' },
    { from: 'ancestralidade', to: 'memoria' },
    { from: 'ancestralidade', to: 'identidade' },
    { from: 'ia', to: 'dados' },
    { from: 'ia', to: 'algoritmos' },
    { from: 'ia', to: 'automacao' },
    { from: 'oralidade', to: 'dados', label: 'Dados como Narrativa' },
    { from: 'memoria', to: 'dados', label: 'Digitalização do Passado' },
    { from: 'identidade', to: 'vies', label: 'Impacto no Sujeito' },
    { from: 'dados', to: 'vies', label: 'Origem do Preconceito' },
    { from: 'ancestralidade', to: 'preservacao', label: 'Objeto de Estudo' },
    { from: 'ia', to: 'preservacao', label: 'Ferramenta' },
    { from: 'ancestralidade', to: 'etica', label: 'Valores Humanos' },
    { from: 'ia', to: 'etica', label: 'Alinhamento' },
  ];

  const suggestions = [
    {
      category: "Conceitual & Sintético",
      icon: Lightbulb,
      color: "text-amber-400",
      names: ["Código-Raiz", "Futuro Ancestral", "Algoritmo Griot", "Neo-Gênese", "Dados Vivos"]
    },
    {
      category: "Poético & Evocativo",
      icon: Sparkles,
      color: "text-purple-400",
      names: ["Ecos do Silício", "Memória Reinventada", "O Amanhã de Ontem", "Tecelões Digitais", "Vozes do Algoritmo"]
    },
    {
      category: "Crítico & Provocador",
      icon: Terminal,
      color: "text-cyan-400",
      names: ["Viés & Verdade", "Descolonizando a IA", "A Máquina Ancestral", "Ética da Herança", "Humanidade 2.0?"]
    }
  ];

  const getNodeColor = (theme) => {
    switch (theme) {
      case 'organic': return 'bg-amber-600 border-amber-400 text-amber-50';
      case 'tech': return 'bg-cyan-600 border-cyan-400 text-cyan-50';
      case 'critical': return 'bg-purple-600 border-purple-400 text-purple-50';
      default: return 'bg-gray-500';
    }
  };

  const getProvocation = (id) => {
    const provocations = {
      'vies': "Se a IA aprende com o passado, como podemos impedir que ela aprenda a ser preconceituosa sem apagar a história?",
      'ancestralidade': "A ancestralidade é sobre raízes fixas ou sobre a continuidade de um fluxo? A IA pode fazer parte desse fluxo?",
      'ia': "Inteligência sem corpo, sem mortalidade e sem medo pode realmente entender a experiência humana?",
      'dados': "Dados são fatos ou interpretações fossilizadas?",
      'memoria': "O backup na nuvem é a nova tradição oral? O que acontece quando o servidor desliga?",
      'etica': "A ética da IA deve priorizar a eficiência (lógica da máquina) ou o bem-estar (lógica do ancestral)?",
      'preservacao': "Digitalizar um ritual sagrado retira sua sacralidade?",
      'automacao': "Se pararmos de criar e apenas gerarmos, nos tornamos ancestrais estéreis para o futuro?",
      'algoritmos': "Algoritmos são opiniões embutidas em matemática.",
      'oralidade': "Chatbots são contadores de histórias que nunca viveram as histórias que contam.",
      'identidade': "Você é você, ou é o perfil de dados que o algoritmo construiu sobre você?"
    };
    return provocations[id] || "";
  };

  const getTooltipStyle = (node) => {
    const isRightSide = node.x > 400;
    const left = isRightSide ? node.x - 300 : node.x + 80;
    const top = node.y - 20;
    return { left, top };
  };

  return (
    <div className="flex flex-col min-h-screen bg-slate-900 text-slate-100 font-sans overflow-x-hidden">
      
      {/* Header */}
      <div className="p-4 border-b border-slate-700 bg-slate-800/50 backdrop-blur flex justify-between items-center z-10 sticky top-0">
        <div>
          <h1 className="text-xl font-bold bg-gradient-to-r from-amber-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent">
            Conexões: Ancestralidade & IA
          </h1>
          <p className="text-xs text-slate-400">Um mapa de tensões entre o passado biológico e o futuro sintético.</p>
        </div>
        <div className="text-xs text-slate-500 hidden md:block">
          Passe o mouse sobre os nós
        </div>
      </div>

      {/* Área do Mapa (Altura fixa para garantir visualização) */}
      <div className="relative h-[600px] w-full bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-800 to-slate-950 border-b border-slate-800"
           style={{ backgroundImage: 'radial-gradient(circle at 1px 1px, rgba(255,255,255,0.05) 1px, transparent 0)', backgroundSize: '40px 40px' }}>
        
        <svg className="absolute inset-0 w-full h-full pointer-events-none">
          {connections.map((conn, idx) => {
            const start = nodes.find(n => n.id === conn.from);
            const end = nodes.find(n => n.id === conn.to);
            if (!start || !end) return null;

            return (
              <g key={idx}>
                <line 
                  x1={start.x + 32} y1={start.y + 32}
                  x2={end.x + 32} y2={end.y + 32}
                  className="stroke-slate-600 stroke-2 opacity-40"
                />
                {conn.label && (
                  <text 
                    x={(start.x + end.x) / 2 + 32} 
                    y={(start.y + end.y) / 2 + 32} 
                    className="fill-slate-500 text-[10px] bg-slate-900"
                    textAnchor="middle"
                    alignmentBaseline="middle"
                  >
                    {conn.label}
                  </text>
                )}
              </g>
            );
          })}
        </svg>

        {nodes.map(node => (
          <div
            key={node.id}
            onMouseEnter={() => setHoveredNode(node)}
            onMouseLeave={() => setHoveredNode(null)}
            className={`absolute w-16 h-16 rounded-full flex items-center justify-center border-2 shadow-lg transition-all duration-300 cursor-pointer z-10
              ${getNodeColor(node.theme)} 
              ${hoveredNode?.id === node.id ? 'scale-110 ring-4 ring-white ring-opacity-20 z-20' : 'opacity-90 hover:opacity-100'}
            `}
            style={{ left: node.x, top: node.y }}
          >
            <node.icon size={24} />
            <span className={`absolute -bottom-8 text-xs font-semibold whitespace-nowrap bg-slate-900/90 px-2 py-1 rounded text-slate-300 border border-slate-700 pointer-events-none transition-opacity duration-200
                ${hoveredNode?.id === node.id ? 'opacity-0' : 'opacity-100'}
            `}>
              {node.label}
            </span>
          </div>
        ))}

        {hoveredNode && (
          <div 
            className="absolute w-72 bg-slate-800/95 border border-slate-600 p-4 rounded-xl shadow-2xl backdrop-blur-md z-50 pointer-events-none animate-in fade-in zoom-in-95 duration-200"
            style={getTooltipStyle(hoveredNode)}
          >
            <div className="flex items-center gap-2 mb-2 pb-2 border-b border-slate-700">
              <div className={`p-1.5 rounded-full ${getNodeColor(hoveredNode.theme)} bg-opacity-20`}>
                <hoveredNode.icon size={16} />
              </div>
              <h3 className="font-bold text-white text-sm">{hoveredNode.label}</h3>
            </div>
            <p className="text-xs text-slate-300 mb-3 leading-relaxed">{hoveredNode.desc}</p>
            <div className="bg-slate-900/50 p-2 rounded border-l-2 border-amber-500">
                <h4 className="text-[10px] font-bold text-amber-500 mb-1 flex items-center gap-1">
                  <Zap size={10} /> PROVOCAÇÃO
                </h4>
                <p className="text-xs text-slate-400 italic">"{getProvocation(hoveredNode.id)}"</p>
            </div>
          </div>
        )}
      </div>

      {/* Nova Seção: Sugestões de Nomes */}
      <div className="p-8 bg-slate-900 border-t border-slate-800">
        <h2 className="text-2xl font-bold text-center mb-8 text-slate-200">
          Sugestões de Nomes para o Evento
        </h2>
        
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl mx-auto">
          {suggestions.map((group, idx) => (
            <div key={idx} className="bg-slate-800 rounded-xl p-6 border border-slate-700 hover:border-slate-600 transition-colors">
              <div className="flex items-center gap-3 mb-4">
                <group.icon className={group.color} size={24} />
                <h3 className={`font-bold ${group.color}`}>{group.category}</h3>
              </div>
              <ul className="space-y-3">
                {group.names.map((name, i) => (
                  <li key={i} className="flex items-center gap-2 text-slate-300 hover:text-white transition-colors cursor-default">
                    <span className="w-1.5 h-1.5 rounded-full bg-slate-600"></span>
                    {name}
                  </li>
                ))}
              </ul>
            </div>
          ))}
        </div>
      </div>

    </div>
  );
};

export default MindMap;